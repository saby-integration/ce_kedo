
Функция ПодготовитьДанныеПрочийКадровыйРасчетныйЛисток(ПараметрыЗапроса) Экспорт

	ПараметрыВызова = Новый Массив;	
	Запрос = Новый Запрос;
	ТекстЗапроса ="ВЫБРАТЬ РАЗРЕШЕННЫЕ 				0 КАК Цифра 			ПОМЕСТИТЬ ВТЦифры 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				1 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				2 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				3 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				4 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				5 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				6 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				7 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				8 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				9 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), МЕСЯЦ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), МЕСЯЦ) КАК Период 			ПОМЕСТИТЬ ПредставленияПериоды 			ИЗ 				ВТЦифры КАК Цифры 					ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10 					ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ), МЕСЯЦ) > 9) 					ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100 					ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ), МЕСЯЦ) > 99) 					ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры1000 					ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ), МЕСЯЦ) > 999) 					ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры10000 					ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ), МЕСЯЦ) > 9999) 					ЛЕВОЕ СОЕДИНЕНИЕ ВТЦифры КАК Цифры100000 					ПО (РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ), МЕСЯЦ) > 99999) 			ГДЕ 				НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), МЕСЯЦ, Цифры.Цифра + ЕСТЬNULL(Цифры10.Цифра, 0) * 10 + ЕСТЬNULL(Цифры100.Цифра, 0) * 100 + ЕСТЬNULL(Цифры1000.Цифра, 0) * 1000 + ЕСТЬNULL(Цифры10000.Цифра, 0) * 10000 + ЕСТЬNULL(Цифры100000.Цифра, 0) * 100000), МЕСЯЦ) МЕЖДУ &НачалоПериода И &КонецПериода 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТЦифры 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник, 				ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо, 				ВзаиморасчетыССотрудниками.Организация КАК Организация, 				ВзаиморасчетыССотрудниками.Подразделение КАК Подразделение, 				ВзаиморасчетыССотрудниками.СуммаВзаиморасчетовНачальныйОстаток КАК НачальныйОстаток, 				ВзаиморасчетыССотрудниками.СуммаВзаиморасчетовКонечныйОстаток КАК КонечныйОстаток, 				ВзаиморасчетыССотрудниками.Период КАК Период 			ПОМЕСТИТЬ ВТОстаткиИОборотыВзаиморасчетовССотрудниками 			ИЗ 				РегистрНакопления.ВзаиморасчетыССотрудниками.ОстаткиИОбороты( 						НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ), 						КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ), 						Месяц, 						, 						ВЫБОР 								КОГДА &ЕстьФильтрПоОрганизации 									ТОГДА Организация = &Организация 								ИНАЧЕ ИСТИНА 							КОНЕЦ 							И ВЫБОР 								КОГДА &ЕстьФильтрПоСотрудникам 									ТОГДА ФизическоеЛицо В (&ФизическиеЛица) 								ИНАЧЕ ИСТИНА 							КОНЕЦ) КАК ВзаиморасчетыССотрудниками 			 			ИНДЕКСИРОВАТЬ ПО 				Сотрудник 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) КАК МесяцНачисления, 				НачисленияИУдержания.Период КАК Период, 				НачисленияИУдержания.ФизическоеЛицо КАК ФизическоеЛицо, 				НачисленияИУдержания.Подразделение КАК Подразделение, 				НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты КАК Группа, 				НачисленияИУдержания.НачислениеУдержание КАК ВидРасчета, 				СУММА(НачисленияИУдержания.Сумма) КАК Сумма, 				НачисленияИУдержания.Организация КАК Организация, 				НачисленияИУдержания.Сотрудник КАК Сотрудник, 				НачисленияИУдержания.ДатаНачала КАК ДатаНачала, 				НачисленияИУдержания.ДатаОкончания КАК ДатаОкончания, 				НачисленияИУдержания.ПериодДействия КАК ПериодДействия, 				НачисленияИУдержания.Регистратор КАК Регистратор, 				НачисленияИУдержания.ДокументОснование КАК ДокументОснование, 				НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки, 				ИСТИНА КАК НачислениеТекущегоПериода 			ПОМЕСТИТЬ ВТНачисленияИУдержанияБезКадровыхДанных 			ИЗ 				РегистрНакопления.НачисленияУдержанияПоСотрудникам КАК НачисленияИУдержания 			ГДЕ 				НачисленияИУдержания.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА НачисленияИУдержания.Организация = &Организация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА НачисленияИУдержания.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 			 			СГРУППИРОВАТЬ ПО 				НачисленияИУдержания.Период, 				НачисленияИУдержания.ФизическоеЛицо, 				НачисленияИУдержания.Подразделение, 				НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты, 				НачисленияИУдержания.НачислениеУдержание, 				НачисленияИУдержания.Организация, 				НачисленияИУдержания.Сотрудник, 				НачисленияИУдержания.ДатаНачала, 				НачисленияИУдержания.ДатаОкончания, 				НачисленияИУдержания.ПериодДействия, 				НачисленияИУдержания.Регистратор, 				НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ), 				НачисленияИУдержания.ДокументОснование, 				НачисленияИУдержания.ИдентификаторСтроки 			 			ОБЪЕДИНИТЬ 			 			ВЫБРАТЬ РАЗЛИЧНЫЕ 				НАЧАЛОПЕРИОДА(НачисленияИУдержания.ПериодДействия, МЕСЯЦ), 				НачисленияИУдержания.Период, 				НачисленияИУдержания.ФизическоеЛицо, 				НачисленияИУдержания.Подразделение, 				НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты, 				НачисленияИУдержания.НачислениеУдержание, 				0, 				НачисленияИУдержания.Организация, 				НачисленияИУдержания.Сотрудник, 				НачисленияИУдержания.ДатаНачала, 				НачисленияИУдержания.ДатаОкончания, 				НачисленияИУдержания.ПериодДействия, 				НачисленияИУдержания.Регистратор, 				НачисленияИУдержания.ДокументОснование, 				НачисленияИУдержания.ИдентификаторСтроки, 				ЛОЖЬ 			ИЗ 				РегистрНакопления.НачисленияУдержанияПоСотрудникам КАК НачисленияИУдержания 			ГДЕ 				НачисленияИУдержания.ПериодДействия МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И НачисленияИУдержания.ПериодДействия <> НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) 				И ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА НачисленияИУдержания.Организация = &Организация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА НачисленияИУдержания.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ 				ОстаткиИОбороты.Организация КАК Организация, 				ОстаткиИОбороты.Сотрудник КАК Сотрудник, 				ОстаткиИОбороты.ФизическоеЛицо КАК ФизическоеЛицо, 				ОстаткиИОбороты.Подразделение КАК Подразделение, 				КОНЕЦПЕРИОДА(ОстаткиИОбороты.Период, МЕСЯЦ) КАК Период 			ПОМЕСТИТЬ ВТГруппировкаСотрудниковПоПериодам 			ИЗ 				ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты 			 			ОБЪЕДИНИТЬ 			 			ВЫБРАТЬ РАЗЛИЧНЫЕ 				НачисленияИУдержания.Организация, 				НачисленияИУдержания.Сотрудник, 				НачисленияИУдержания.ФизическоеЛицо, 				НачисленияИУдержания.Подразделение, 				КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) 			ИЗ 				ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания 			 			ОБЪЕДИНИТЬ 			 			ВЫБРАТЬ РАЗЛИЧНЫЕ 				НачисленияИУдержания.Организация, 				НачисленияИУдержания.Сотрудник, 				НачисленияИУдержания.ФизическоеЛицо, 				НачисленияИУдержания.Подразделение, 				НачисленияИУдержания.ДатаНачала 			ИЗ 				ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания 			ГДЕ 				НачисленияИУдержания.ДатаНачала <> ДАТАВРЕМЯ(1, 1, 1) 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ 				ОстаткиИОбороты.Организация КАК Организация, 				ОстаткиИОбороты.Сотрудник КАК Сотрудник, 				ОстаткиИОбороты.ФизическоеЛицо КАК ФизическоеЛицо, 				ОстаткиИОбороты.Подразделение КАК Подразделение, 				Месяцы.Период КАК Месяц 			ПОМЕСТИТЬ ВТГруппировкаСотрудниковПоМесяцам 			ИЗ 				ВТГруппировкаСотрудниковПоПериодам КАК ОстаткиИОбороты 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияПериоды КАК Месяцы 					ПО (ИСТИНА) 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ 				ГруппировкаСотрудниковПоПериодам.Сотрудник КАК Сотрудник, 				ГруппировкаСотрудниковПоПериодам.Период КАК Период 			ПОМЕСТИТЬ ВТГруппировкаСотрудникПериод 			ИЗ 				ВТГруппировкаСотрудниковПоПериодам КАК ГруппировкаСотрудниковПоПериодам 			 			ОБЪЕДИНИТЬ 			 			ВЫБРАТЬ РАЗЛИЧНЫЕ 				ГруппировкаСотрудниковПоМесяцам.Сотрудник, 				ГруппировкаСотрудниковПоМесяцам.Месяц 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ГруппировкаСотрудниковПоМесяцам 			 			ОБЪЕДИНИТЬ 			 			ВЫБРАТЬ РАЗЛИЧНЫЕ 				ГруппировкаСотрудниковПоМесяцам.Сотрудник, 				КОНЕЦПЕРИОДА(ГруппировкаСотрудниковПоМесяцам.Месяц, МЕСЯЦ) 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ГруппировкаСотрудниковПоМесяцам 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТГруппировкаСотрудниковПоПериодам 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ 				ГруппировкаСотрудникПериод.Период КАК Период, 				ГруппировкаСотрудникПериод.Сотрудник КАК Сотрудник, 				СправочникСотрудники.ФизическоеЛицо КАК ФизическоеЛицо 			ПОМЕСТИТЬ ВТГруппировкаСотрудникПериодФизЛицо 			ИЗ 				ВТГруппировкаСотрудникПериод КАК ГруппировкаСотрудникПериод 					ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Сотрудники КАК СправочникСотрудники 					ПО ГруппировкаСотрудникПериод.Сотрудник = СправочникСотрудники.Ссылка 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОбтобранныеСотрудники.Период КАК Период, 				РегистрСведений.Организация КАК Организация, 				РегистрСведений.Подразделение КАК Подразделение, 				РегистрСведений.Должность КАК Должность 			ПОМЕСТИТЬ ВТСведенияКадровойИсторииСотрудников 			ИЗ 				ВТГруппировкаСотрудникПериодФизЛицо КАК ОбтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КадроваяИсторияСотрудниковИнтервальный КАК РегистрСведений 					ПО (РегистрСведений.ДатаНачала <= ВЫБОР 							КОГДА ОбтобранныеСотрудники.Период = ДАТАВРЕМЯ(1, 1, 1) 								ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59) 							ИНАЧЕ КОНЕЦПЕРИОДА(ОбтобранныеСотрудники.Период, ДЕНЬ) 						КОНЕЦ) 						И (РегистрСведений.ДатаОкончания >= ВЫБОР 							КОГДА ОбтобранныеСотрудники.Период = ДАТАВРЕМЯ(1, 1, 1) 								ТОГДА ДАТАВРЕМЯ(3999, 12, 31, 23, 59, 59) 							ИНАЧЕ КОНЕЦПЕРИОДА(ОбтобранныеСотрудники.Период, ДЕНЬ) 						КОНЕЦ) 						И (РегистрСведений.Сотрудник = ОбтобранныеСотрудники.Сотрудник) 						И (РегистрСведений.ФизическоеЛицо = ОбтобранныеСотрудники.Сотрудник.ФизическоеЛицо) 			 			ИНДЕКСИРОВАТЬ ПО 				Сотрудник 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.Период КАК Период, 				ОбтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОбтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				КадроваяИсторияСотрудников.Организация КАК Организация, 				КадроваяИсторияСотрудников.Подразделение КАК Подразделение, 				КадроваяИсторияСотрудников.Должность КАК Должность, 				ЕСТЬNULL(ТекущиеКадровыеДанныеСотрудников.ДатаУвольнения, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаУвольнения, 				ЕСТЬNULL(ТекущиеКадровыеДанныеСотрудников.ДатаПриема, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаПриема 			ПОМЕСТИТЬ ПредставленияКадровыеДанныеСотрудников 			ИЗ 				ВТГруппировкаСотрудникПериодФизЛицо КАК ОбтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ТекущиеКадровыеДанныеСотрудников КАК ТекущиеКадровыеДанныеСотрудников 					ПО ОбтобранныеСотрудники.Сотрудник = ТекущиеКадровыеДанныеСотрудников.Сотрудник 					ЛЕВОЕ СОЕДИНЕНИЕ ВТСведенияКадровойИсторииСотрудников КАК КадроваяИсторияСотрудников 					ПО ОбтобранныеСотрудники.Сотрудник = КадроваяИсторияСотрудников.Сотрудник 						И ОбтобранныеСотрудники.Период = КадроваяИсторияСотрудников.Период 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТСведенияКадровойИсторииСотрудников 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОбтобранныеСотрудники.Период КАК Период, 				NULL КАК ГрафикРаботы 			ПОМЕСТИТЬ ПредставленияГрафиковРаботыСотрудников 			ИЗ 				ВТГруппировкаСотрудникПериодФизЛицо КАК ОбтобранныеСотрудники			 			ИНДЕКСИРОВАТЬ ПО 				Сотрудник 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				КОНЕЦПЕРИОДА(ОбтобранныеСотрудники.Период, МЕСЯЦ) КАК ПериодСбораДанных 			ПОМЕСТИТЬ ВТГруппировкаДляОпределенияСтатусаНалогоплательщика 			ИЗ 				ВТГруппировкаСотрудникПериодФизЛицо КАК ОбтобранныеСотрудники 			 			СГРУППИРОВАТЬ ПО 				ОбтобранныеСотрудники.ФизическоеЛицо, 				КОНЕЦПЕРИОДА(ОбтобранныеСотрудники.Период, МЕСЯЦ) 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбтобранныеСотрудники.ПериодСбораДанных КАК ПериодСбораДанных, 				МАКСИМУМ(СтатусФизическихЛицКакНалогоплательщиковНДФЛ.Период) КАК МаксПериод 			ПОМЕСТИТЬ ВТМаксимальныйПериодСтатусаНалогоплательщика 			ИЗ 				ВТГруппировкаДляОпределенияСтатусаНалогоплательщика КАК ОбтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтатусФизическихЛицКакНалогоплательщиковНДФЛ КАК СтатусФизическихЛицКакНалогоплательщиковНДФЛ 					ПО ОбтобранныеСотрудники.ФизическоеЛицо = СтатусФизическихЛицКакНалогоплательщиковНДФЛ.ФизическоеЛицо 						И ОбтобранныеСотрудники.ПериодСбораДанных >= СтатусФизическихЛицКакНалогоплательщиковНДФЛ.Период 			 			СГРУППИРОВАТЬ ПО 				ОбтобранныеСотрудники.ФизическоеЛицо, 				ОбтобранныеСотрудники.ПериодСбораДанных 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				МаксимальныйСтатуса.ФизическоеЛицо КАК ФизическоеЛицо, 				МаксимальныйСтатуса.ПериодСбораДанных КАК ПериодСбораДанных, 				СтатусФизическихЛицКакНалогоплательщиковНДФЛ.Статус КАК Статус 			ПОМЕСТИТЬ СтатусыНалогоплательщиков 			ИЗ 				ВТМаксимальныйПериодСтатусаНалогоплательщика КАК МаксимальныйСтатуса 					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СтатусФизическихЛицКакНалогоплательщиковНДФЛ КАК СтатусФизическихЛицКакНалогоплательщиковНДФЛ 					ПО МаксимальныйСтатуса.ФизическоеЛицо = СтатусФизическихЛицКакНалогоплательщиковНДФЛ.ФизическоеЛицо 						И МаксимальныйСтатуса.МаксПериод = СтатусФизическихЛицКакНалогоплательщиковНДФЛ.Период 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТГруппировкаДляОпределенияСтатусаНалогоплательщика 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТМаксимальныйПериодСтатусаНалогоплательщика 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.Организация КАК Организация, 				ОбтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОбтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбтобранныеСотрудники.Подразделение КАК Подразделение, 				ОбтобранныеСотрудники.Месяц КАК Месяц, 				МАКСИМУМ(ОстаткиИОбороты.Период) КАК ПоследнийМесяцОстатков 			ПОМЕСТИТЬ ВТСотрудникиМесяцыОстатков 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ОбтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты 					ПО ОбтобранныеСотрудники.Организация = ОстаткиИОбороты.Организация 						И ОбтобранныеСотрудники.Сотрудник = ОстаткиИОбороты.Сотрудник 						И ОбтобранныеСотрудники.ФизическоеЛицо = ОстаткиИОбороты.ФизическоеЛицо 						И ОбтобранныеСотрудники.Подразделение = ОстаткиИОбороты.Подразделение 						И ОбтобранныеСотрудники.Месяц >= ОстаткиИОбороты.Период 			 			СГРУППИРОВАТЬ ПО 				ОбтобранныеСотрудники.Организация, 				ОбтобранныеСотрудники.Сотрудник, 				ОбтобранныеСотрудники.ФизическоеЛицо, 				ОбтобранныеСотрудники.Подразделение, 				ОбтобранныеСотрудники.Месяц 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				СотрудникиМесяцыОстатков.Организация КАК Организация, 				СотрудникиМесяцыОстатков.Сотрудник КАК Сотрудник, 				СотрудникиМесяцыОстатков.ФизическоеЛицо КАК ФизическоеЛицо, 				СотрудникиМесяцыОстатков.Подразделение КАК Подразделение, 				ЕСТЬNULL(ОстаткиИОбороты.НачальныйОстаток, ОстаткиИОборотыПоследние.КонечныйОстаток) КАК НачальныйОстаток, 				ЕСТЬNULL(ОстаткиИОбороты.КонечныйОстаток, ОстаткиИОборотыПоследние.КонечныйОстаток) КАК КонечныйОстаток, 				КОНЕЦПЕРИОДА(СотрудникиМесяцыОстатков.Месяц, МЕСЯЦ) КАК Период 			ПОМЕСТИТЬ ВТСальдоВсеСотрудникиПериоды 			ИЗ 				ВТСотрудникиМесяцыОстатков КАК СотрудникиМесяцыОстатков 					ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты 					ПО СотрудникиМесяцыОстатков.Организация = ОстаткиИОбороты.Организация 						И СотрудникиМесяцыОстатков.Сотрудник = ОстаткиИОбороты.Сотрудник 						И СотрудникиМесяцыОстатков.ФизическоеЛицо = ОстаткиИОбороты.ФизическоеЛицо 						И СотрудникиМесяцыОстатков.Подразделение = ОстаткиИОбороты.Подразделение 						И СотрудникиМесяцыОстатков.Месяц = ОстаткиИОбороты.Период 					ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОборотыПоследние 					ПО СотрудникиМесяцыОстатков.Организация = ОстаткиИОборотыПоследние.Организация 						И СотрудникиМесяцыОстатков.Сотрудник = ОстаткиИОборотыПоследние.Сотрудник 						И СотрудникиМесяцыОстатков.ФизическоеЛицо = ОстаткиИОборотыПоследние.ФизическоеЛицо 						И СотрудникиМесяцыОстатков.Подразделение = ОстаткиИОборотыПоследние.Подразделение 						И СотрудникиМесяцыОстатков.ПоследнийМесяцОстатков = ОстаткиИОборотыПоследние.Период 			ГДЕ 				(НЕ ЕСТЬNULL(ОстаткиИОборотыПоследние.КонечныйОстаток, ОстаткиИОбороты.НачальныйОстаток) ЕСТЬ NULL 						ИЛИ НЕ ОстаткиИОбороты.КонечныйОстаток ЕСТЬ NULL) 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник, 				ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо, 				ВзаиморасчетыССотрудниками.Организация КАК Организация, 				ВзаиморасчетыССотрудниками.НачальныйОстаток КАК НачальныйОстаток, 				ВзаиморасчетыССотрудниками.КонечныйОстаток КАК КонечныйОстаток, 				НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК Период, 				КадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода, 				КадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода, 				ГрафикиРаботыСотрудников.ГрафикРаботы КАК ГрафикРаботы 			ПОМЕСТИТЬ ВТСальдоПоРасчетамССотрудниками 			ИЗ 				ВТСальдоВсеСотрудникиПериоды КАК ВзаиморасчетыССотрудниками 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК КадровыеДанныеСотрудников 					ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеСотрудников.Период) 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияГрафиковРаботыСотрудников КАК ГрафикиРаботыСотрудников 					ПО ВзаиморасчетыССотрудниками.Сотрудник = ГрафикиРаботыСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ГрафикиРаботыСотрудников.Период) 			ГДЕ 				ВЫБОР 						КОГДА ВзаиморасчетыССотрудниками.НачальныйОстаток <> 0 							ТОГДА ИСТИНА 						КОГДА ВзаиморасчетыССотрудниками.КонечныйОстаток <> 0 							ТОГДА ИСТИНА 						КОГДА КадровыеДанныеСотрудников.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1) 							ТОГДА ИСТИНА 						КОГДА КадровыеДанныеСотрудников.ДатаУвольнения >= НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) 							ТОГДА ИСТИНА 						ИНАЧЕ ЛОЖЬ 					КОНЕЦ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК МесяцНачисления, 				ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо, 				ВзаиморасчетыССотрудниками.ВидВзаиморасчетов КАК ВидРасчета, 				ВзаиморасчетыССотрудниками.СуммаВзаиморасчетов КАК Сумма, 				ВЫБОР 					КОГДА НЕ ВзаиморасчетыССотрудниками.Подразделение.Владелец ЕСТЬ NULL 						ТОГДА ВзаиморасчетыССотрудниками.Подразделение.Владелец 					КОГДА КадровыеДанныеСотрудников.Организация <> ЗНАЧЕНИЕ(СПРАВОЧНИК.Организации.ПустаяСсылка) 						ТОГДА КадровыеДанныеСотрудников.Организация 					ИНАЧЕ ВзаиморасчетыССотрудниками.Организация 				КОНЕЦ КАК Организация, 				ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник, 				НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК ПериодДействия, 				ВзаиморасчетыССотрудниками.Регистратор КАК Регистратор, 				КадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода, 				КадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода, 				ГрафикиРаботыСотрудников.ГрафикРаботы КАК ГрафикРаботы 			ПОМЕСТИТЬ ВТДвиженияВзаиморасчетов 			ИЗ 				РегистрНакопления.ВзаиморасчетыССотрудниками КАК ВзаиморасчетыССотрудниками 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК КадровыеДанныеСотрудников 					ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеСотрудников.Период) 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияГрафиковРаботыСотрудников КАК ГрафикиРаботыСотрудников 					ПО ВзаиморасчетыССотрудниками.Сотрудник = ГрафикиРаботыСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ГрафикиРаботыСотрудников.Период) 			ГДЕ 				ВзаиморасчетыССотрудниками.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И ВзаиморасчетыССотрудниками.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 				И ВзаиморасчетыССотрудниками.ВидВзаиморасчетов <> ЗНАЧЕНИЕ(Перечисление.ВидыВзаиморасчетовССотрудниками.ПустаяСсылка) 				И ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА ВзаиморасчетыССотрудниками.Организация = &Организация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА ВзаиморасчетыССотрудниками.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НачисленияИУдержания.МесяцНачисления КАК МесяцНачисления, 				НачисленияИУдержания.ФизическоеЛицо КАК ФизическоеЛицо, 				НачисленияИУдержания.Подразделение КАК Подразделение, 				НачисленияИУдержания.Группа КАК Группа, 				НачисленияИУдержания.ВидРасчета КАК ВидРасчета, 				НачисленияИУдержания.Сумма КАК Сумма, 				НачисленияИУдержания.Организация КАК Организация, 				НачисленияИУдержания.Сотрудник КАК Сотрудник, 				НачисленияИУдержания.ДатаНачала КАК ДатаНачала, 				НачисленияИУдержания.ДатаОкончания КАК ДатаОкончания, 				НачисленияИУдержания.ПериодДействия КАК ПериодДействия, 				НачисленияИУдержания.Регистратор КАК Регистратор, 				КадровыеДанныеСотрудниковНаКонецПериода.Должность КАК ДолжностьНаКонецПериода, 				КадровыеДанныеСотрудниковНаКонецПериода.Подразделение КАК ПодразделениеНаКонецПериода, 				ГрафикиРаботыСотрудников.ГрафикРаботы КАК ГрафикРаботы, 				НачисленияИУдержания.ДокументОснование КАК ДокументОснование, 				НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки, 				НачисленияИУдержания.НачислениеТекущегоПериода КАК НачислениеТекущегоПериода 			ПОМЕСТИТЬ ВТНачисленияИУдержанияСКадровымиДанными 			ИЗ 				ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК КадровыеДанныеСотрудниковНаКонецПериода 					ПО НачисленияИУдержания.Сотрудник = КадровыеДанныеСотрудниковНаКонецПериода.Сотрудник 						И (КОНЕЦПЕРИОДА(НачисленияИУдержания.МесяцНачисления, МЕСЯЦ) = КадровыеДанныеСотрудниковНаКонецПериода.Период) 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияГрафиковРаботыСотрудников КАК ГрафикиРаботыСотрудников 					ПО НачисленияИУдержания.Сотрудник = ГрафикиРаботыСотрудников.Сотрудник 						И НачисленияИУдержания.ДатаНачала = ГрафикиРаботыСотрудников.Период 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НачисленияИУдержанияСКадровымиДанными.Организация КАК Организация, 				НачисленияИУдержанияСКадровымиДанными.ФизическоеЛицо КАК ФизическоеЛицо, 				НачисленияИУдержанияСКадровымиДанными.Сотрудник КАК Сотрудник, 				НачисленияИУдержанияСКадровымиДанными.ДатаОкончания КАК ДатаОкончания, 				МАКСИМУМ(ПредставленияКадровыеДанныеСотрудников.Период) КАК Период 			ПОМЕСТИТЬ ВТМаксимальныйПериодКадровыхДанныхНаКонецНачисления 			ИЗ 				ВТНачисленияИУдержанияСКадровымиДанными КАК НачисленияИУдержанияСКадровымиДанными 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников 					ПО НачисленияИУдержанияСКадровымиДанными.Организация = ПредставленияКадровыеДанныеСотрудников.Организация 						И НачисленияИУдержанияСКадровымиДанными.ФизическоеЛицо = ПредставленияКадровыеДанныеСотрудников.ФизическоеЛицо 						И НачисленияИУдержанияСКадровымиДанными.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник 						И НачисленияИУдержанияСКадровымиДанными.ДатаОкончания >= ПредставленияКадровыеДанныеСотрудников.Период 			 			СГРУППИРОВАТЬ ПО 				НачисленияИУдержанияСКадровымиДанными.Организация, 				НачисленияИУдержанияСКадровымиДанными.ФизическоеЛицо, 				НачисленияИУдержанияСКадровымиДанными.Сотрудник, 				НачисленияИУдержанияСКадровымиДанными.ДатаОкончания 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбтобранныеСотрудники.Организация КАК Организация, 				ОбтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОбтобранныеСотрудники.ДатаОкончания КАК ДатаОкончания, 				ПредставленияКадровыеДанныеСотрудников.Подразделение КАК Подразделение, 				ПредставленияКадровыеДанныеСотрудников.Должность КАК Должность 			ПОМЕСТИТЬ ПредставленияКадровыхДанныхНаКонецНачисления 			ИЗ 				ВТМаксимальныйПериодКадровыхДанныхНаКонецНачисления КАК ОбтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников 					ПО ОбтобранныеСотрудники.Организация = ПредставленияКадровыеДанныеСотрудников.Организация 						И ОбтобранныеСотрудники.ФизическоеЛицо = ПредставленияКадровыеДанныеСотрудников.ФизическоеЛицо 						И ОбтобранныеСотрудники.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник 						И ОбтобранныеСотрудники.Период = ПредставленияКадровыеДанныеСотрудников.Период 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТМаксимальныйПериодКадровыхДанныхНаКонецНачисления 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НАЧАЛОПЕРИОДА(ОтработанноеВремя.Период, МЕСЯЦ) КАК МесяцНачисления, 				ОтработанноеВремя.Регистратор КАК Регистратор, 				ОтработанноеВремя.Сотрудник КАК Сотрудник, 				ОтработанноеВремя.Организация КАК Организация, 				ОтработанноеВремя.Подразделение КАК Подразделение, 				ОтработанноеВремя.Начисление КАК ВидРасчета, 				ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах, 				ОтработанноеВремя.ИдентификаторСтроки КАК ИдентификаторСтроки, 				ОтработанноеВремя.ОтработаноДней КАК ОтработаноДней, 				ОтработанноеВремя.ОтработаноЧасов КАК ОтработаноЧасов, 				ОтработанноеВремя.ОплаченоДней КАК ОплаченоДней, 				ОтработанноеВремя.ОплаченоЧасов КАК ОплаченоЧасов 			ПОМЕСТИТЬ ВТПериодыОтработанноеВремяСКорректировками 			ИЗ 				РегистрНакопления.ОтработанноеВремяПоСотрудникам КАК ОтработанноеВремя 			ГДЕ 				ОтработанноеВремя.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА ОтработанноеВремя.Организация = &Организация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА ОтработанноеВремя.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтработанноеВремяВПериодахСКорректировками.МесяцНачисления КАК МесяцНачисления, 				ОтработанноеВремяВПериодахСКорректировками.Регистратор КАК Регистратор, 				ОтработанноеВремяВПериодахСКорректировками.Сотрудник КАК Сотрудник, 				ОтработанноеВремяВПериодахСКорректировками.Организация КАК Организация, 				ОтработанноеВремяВПериодахСКорректировками.Подразделение КАК Подразделение, 				ОтработанноеВремяВПериодахСКорректировками.ВидРасчета КАК ВидРасчета, 				ОтработанноеВремяВПериодахСКорректировками.ВремяВЧасах КАК ВремяВЧасах, 				ОтработанноеВремяВПериодахСКорректировками.ИдентификаторСтроки КАК ИдентификаторСтроки, 				СУММА(ОтработанноеВремяВПериодахСКорректировками.ОтработаноДней) КАК ОтработаноДней, 				СУММА(ОтработанноеВремяВПериодахСКорректировками.ОтработаноЧасов) КАК ОтработаноЧасов, 				СУММА(ОтработанноеВремяВПериодахСКорректировками.ОплаченоДней) КАК ОплаченоДней, 				СУММА(ОтработанноеВремяВПериодахСКорректировками.ОплаченоЧасов) КАК ОплаченоЧасов 			ПОМЕСТИТЬ ПредставленияОтработанноеВремя 			ИЗ 				ВТПериодыОтработанноеВремяСКорректировками КАК ОтработанноеВремяВПериодахСКорректировками 			 			СГРУППИРОВАТЬ ПО 				ОтработанноеВремяВПериодахСКорректировками.МесяцНачисления, 				ОтработанноеВремяВПериодахСКорректировками.Регистратор, 				ОтработанноеВремяВПериодахСКорректировками.Сотрудник, 				ОтработанноеВремяВПериодахСКорректировками.Подразделение, 				ОтработанноеВремяВПериодахСКорректировками.ВидРасчета, 				ОтработанноеВремяВПериодахСКорректировками.ВремяВЧасах, 				ОтработанноеВремяВПериодахСКорректировками.ИдентификаторСтроки, 				ОтработанноеВремяВПериодахСКорректировками.Организация 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТПериодыОтработанноеВремяСКорректировками 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц КАК Месяц 			ПОМЕСТИТЬ ВТГруппировкаДляДанныхНДФЛ 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ОтобранныеСотрудники 			 			СГРУППИРОВАТЬ ПО 				ОтобранныеСотрудники.Организация.ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				СведенияОДоходахНДФЛ.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				СведенияОДоходахНДФЛ.ФизическоеЛицо КАК ФизическоеЛицо, 				СведенияОДоходахНДФЛ.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода, 				СУММА(СведенияОДоходахНДФЛ.СуммаДохода) КАК СуммаДохода, 				СУММА(ВЫБОР 						КОГДА СведенияОДоходахНДФЛ.КодВычета = ЗНАЧЕНИЕ(Справочник.ВидыВычетовНДФЛ.ПустаяСсылка) 							ТОГДА 0 						ИНАЧЕ СведенияОДоходахНДФЛ.СуммаВычета 					КОНЕЦ) КАК СуммаВычета 			ПОМЕСТИТЬ ВТСведенияОДоходахНДФЛ 			ИЗ 				РегистрНакопления.СведенияОДоходахНДФЛ КАК СведенияОДоходахНДФЛ 			ГДЕ 				ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА СведенияОДоходахНДФЛ.ГоловнаяОрганизация = ВЫРАЗИТЬ(&Организация КАК Справочник.Организации).ГоловнаяОрганизация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА СведенияОДоходахНДФЛ.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И НЕ СведенияОДоходахНДФЛ.КодДохода.НеОблагаетсяУНалоговогоАгента 				И СведенияОДоходахНДФЛ.Период <= КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И СведенияОДоходахНДФЛ.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ГОД) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 			 			СГРУППИРОВАТЬ ПО 				СведенияОДоходахНДФЛ.ФизическоеЛицо, 				СведенияОДоходахНДФЛ.МесяцНалоговогоПериода, 				СведенияОДоходахНДФЛ.ГоловнаяОрганизация 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				СУММА(ЕСТЬNULL(СведенияОДоходахНДФЛ.СуммаДохода, 0)) КАК СуммаДохода, 				СУММА(ЕСТЬNULL(СведенияОДоходахНДФЛ.СуммаВычета, 0)) КАК СуммаВычета, 				СУММА(ЕСТЬNULL(СведенияОДоходахНДФЛ.СуммаДохода, 0)) - СУММА(ЕСТЬNULL(СведенияОДоходахНДФЛ.СуммаВычета, 0)) КАК ОблагаемыйДоход 			ПОМЕСТИТЬ ВТОблагаемыйДоходПоФизЛицам 			ИЗ 				ВТГруппировкаДляДанныхНДФЛ КАК ОтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТСведенияОДоходахНДФЛ КАК СведенияОДоходахНДФЛ 					ПО ОтобранныеСотрудники.ГоловнаяОрганизация = СведенияОДоходахНДФЛ.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = СведенияОДоходахНДФЛ.ФизическоеЛицо 						И (СведенияОДоходахНДФЛ.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(ОтобранныеСотрудники.Месяц, ГОД) И КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ)) 			 			СГРУППИРОВАТЬ ПО 				ОтобранныеСотрудники.ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.Организация КАК Организация, 				ОтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Подразделение КАК Подразделение, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.СуммаДохода, 0) КАК СуммаДохода, 				ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.СуммаВычета, 0) КАК СуммаВычета, 				ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.ОблагаемыйДоход, 0) КАК ОблагаемыйДоход, 				ПредставленияКадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода, 				ПредставленияКадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода 			ПОМЕСТИТЬ ДанныеОблагаемыйНалог 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ОтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТОблагаемыйДоходПоФизЛицам КАК ОблагаемыйДоходПоФизЛицам 					ПО ОтобранныеСотрудники.Организация.ГоловнаяОрганизация = ОблагаемыйДоходПоФизЛицам.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = ОблагаемыйДоходПоФизЛицам.ФизическоеЛицо 						И ОтобранныеСотрудники.Месяц = ОблагаемыйДоходПоФизЛицам.Месяц 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников 					ПО ОтобранныеСотрудники.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ) = ПредставленияКадровыеДанныеСотрудников.Период) 			ГДЕ 				(ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.СуммаДохода, 0) <> 0 						ИЛИ ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.СуммаВычета, 0) <> 0 						ИЛИ ЕСТЬNULL(ОблагаемыйДоходПоФизЛицам.ОблагаемыйДоход, 0) <> 0) 				И НЕ ПредставленияКадровыеДанныеСотрудников.Должность ЕСТЬ NULL 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ФизическоеЛицо КАК ФизическоеЛицо, 				ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				НАЧАЛОПЕРИОДА(ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.Период, МЕСЯЦ) КАК МесяцНалоговогоПериода, 				СУММА(ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.Сумма) КАК СуммаВычета 			ПОМЕСТИТЬ ВТСведенияОПредоставленныхВычетахНДФЛ 			ИЗ 				РегистрНакопления.ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ КАК ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ 			ГДЕ 				ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ГоловнаяОрганизация = ВЫРАЗИТЬ(&Организация КАК Справочник.Организации).ГоловнаяОрганизация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ГОД) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 			 			СГРУППИРОВАТЬ ПО 				ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ФизическоеЛицо, 				ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.ГоловнаяОрганизация, 				НАЧАЛОПЕРИОДА(ПредоставленныеСтандартныеИСоциальныеВычетыНДФЛ.Период, МЕСЯЦ) 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ИмущественныеВычетыНДФЛ.ФизическоеЛицо, 				ИмущественныеВычетыНДФЛ.ГоловнаяОрганизация, 				НАЧАЛОПЕРИОДА(ИмущественныеВычетыНДФЛ.Период, МЕСЯЦ), 				СУММА(ИмущественныеВычетыНДФЛ.Сумма) 			ИЗ 				РегистрНакопления.ИмущественныеВычетыНДФЛ КАК ИмущественныеВычетыНДФЛ 			ГДЕ 				ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА ИмущественныеВычетыНДФЛ.ГоловнаяОрганизация = ВЫРАЗИТЬ(&Организация КАК Справочник.Организации).ГоловнаяОрганизация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА ИмущественныеВычетыНДФЛ.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ИмущественныеВычетыНДФЛ.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ГОД) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И ИмущественныеВычетыНДФЛ.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 			 			СГРУППИРОВАТЬ ПО 				ИмущественныеВычетыНДФЛ.ФизическоеЛицо, 				ИмущественныеВычетыНДФЛ.ГоловнаяОрганизация, 				НАЧАЛОПЕРИОДА(ИмущественныеВычетыНДФЛ.Период, МЕСЯЦ) 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВТСведенияОПредоставленныхВычетахНДФЛ.ФизическоеЛицо КАК ФизическоеЛицо, 				ВТСведенияОПредоставленныхВычетахНДФЛ.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				ВТСведенияОПредоставленныхВычетахНДФЛ.МесяцНалоговогоПериода КАК МесяцНалоговогоПериода, 				СУММА(ВТСведенияОПредоставленныхВычетахНДФЛ.СуммаВычета) КАК СуммаВычета 			ПОМЕСТИТЬ ВТСведенияОПредоставленныхВычетахНДФЛСвернуто 			ИЗ 				ВТСведенияОПредоставленныхВычетахНДФЛ КАК ВТСведенияОПредоставленныхВычетахНДФЛ 			 			СГРУППИРОВАТЬ ПО 				ВТСведенияОПредоставленныхВычетахНДФЛ.ФизическоеЛицо, 				ВТСведенияОПредоставленныхВычетахНДФЛ.ГоловнаяОрганизация, 				ВТСведенияОПредоставленныхВычетахНДФЛ.МесяцНалоговогоПериода 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				СУММА(ЕСТЬNULL(СведенияОПредоставленныхВычетахНДФЛ.СуммаВычета, 0)) КАК СуммаВычета 			ПОМЕСТИТЬ ВТВычетыПоФизЛицам 			ИЗ 				ВТГруппировкаДляДанныхНДФЛ КАК ОтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТСведенияОПредоставленныхВычетахНДФЛСвернуто КАК СведенияОПредоставленныхВычетахНДФЛ 					ПО ОтобранныеСотрудники.ГоловнаяОрганизация = СведенияОПредоставленныхВычетахНДФЛ.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = СведенияОПредоставленныхВычетахНДФЛ.ФизическоеЛицо 						И (СведенияОПредоставленныхВычетахНДФЛ.МесяцНалоговогоПериода МЕЖДУ НАЧАЛОПЕРИОДА(ОтобранныеСотрудники.Месяц, ГОД) И КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ)) 			 			СГРУППИРОВАТЬ ПО 				ОтобранныеСотрудники.ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.Организация КАК Организация, 				ОтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Подразделение КАК Подразделение, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				ЕСТЬNULL(ВычетыПоФизЛицам.СуммаВычета, 0) КАК СуммаВычета, 				ПредставленияГрафиковРаботыСотрудников.ГрафикРаботы КАК ГрафикРаботыНаКонецПериода, 				ПредставленияКадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода, 				ПредставленияКадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода 			ПОМЕСТИТЬ ДанныеВычеты 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ОтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТВычетыПоФизЛицам КАК ВычетыПоФизЛицам 					ПО ОтобранныеСотрудники.Организация.ГоловнаяОрганизация = ВычетыПоФизЛицам.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = ВычетыПоФизЛицам.ФизическоеЛицо 						И ОтобранныеСотрудники.Месяц = ВычетыПоФизЛицам.Месяц 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников 					ПО ОтобранныеСотрудники.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ) = ПредставленияКадровыеДанныеСотрудников.Период) 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияГрафиковРаботыСотрудников КАК ПредставленияГрафиковРаботыСотрудников 					ПО ОтобранныеСотрудники.Сотрудник = ПредставленияГрафиковРаботыСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ) = ПредставленияГрафиковРаботыСотрудников.Период) 			ГДЕ 				НЕ ПредставленияКадровыеДанныеСотрудников.Должность ЕСТЬ NULL 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) КАК МесяцНачисления, 				НачисленияИУдержания.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				НачисленияИУдержания.ФизическоеЛицо КАК ФизическоеЛицо, 				СУММА(НачисленияИУдержания.Сумма) КАК Сумма 			ПОМЕСТИТЬ ВТСведенияОНДФЛ 			ИЗ 				РегистрНакопления.НачисленияУдержанияПоСотрудникам КАК НачисленияИУдержания 			ГДЕ 				НачисленияИУдержания.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, ГОД) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ) 				И НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты = ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.Удержано) 				И (НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛ) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛДоначисленныйПоРезультатамПроверки) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛДоходыКонтрагентов) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛПрочиеРасчетыСПерсоналом) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛСПревышения) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НДФЛРасчетыСБывшимиСотрудниками) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НФДЛДивиденды) 						ИЛИ НачисленияИУдержания.НачислениеУдержание = ЗНАЧЕНИЕ(Перечисление.ВидыОсобыхНачисленийИУдержаний.НФДЛДивидендыСотрудникам)) 				И ВЫБОР 						КОГДА &ЕстьФильтрПоОрганизации 							ТОГДА НачисленияИУдержания.Организация.ГоловнаяОрганизация = ВЫРАЗИТЬ(&Организация КАК Справочник.Организации).ГоловнаяОрганизация 						ИНАЧЕ ИСТИНА 					КОНЕЦ 				И ВЫБОР 						КОГДА &ЕстьФильтрПоСотрудникам 							ТОГДА НачисленияИУдержания.ФизическоеЛицо В (&ФизическиеЛица) 						ИНАЧЕ ИСТИНА 					КОНЕЦ 			 			СГРУППИРОВАТЬ ПО 				НачисленияИУдержания.Период, 				НачисленияИУдержания.ФизическоеЛицо, 				НачисленияИУдержания.Организация.ГоловнаяОрганизация 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.ГоловнаяОрганизация КАК ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				СУММА(ЕСТЬNULL(СведенияОНДФЛ.Сумма, 0)) КАК Сумма 			ПОМЕСТИТЬ ВТДанныеСовокупныйНДФЛ 			ИЗ 				ВТГруппировкаДляДанныхНДФЛ КАК ОтобранныеСотрудники 					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСведенияОНДФЛ КАК СведенияОНДФЛ 					ПО ОтобранныеСотрудники.ГоловнаяОрганизация = СведенияОНДФЛ.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = СведенияОНДФЛ.ФизическоеЛицо 						И (СведенияОНДФЛ.МесяцНачисления МЕЖДУ НАЧАЛОПЕРИОДА(ОтобранныеСотрудники.Месяц, ГОД) И КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ)) 			 			СГРУППИРОВАТЬ ПО 				ОтобранныеСотрудники.ГоловнаяОрганизация, 				ОтобранныеСотрудники.ФизическоеЛицо, 				ОтобранныеСотрудники.Месяц 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОтобранныеСотрудники.Организация КАК Организация, 				ОтобранныеСотрудники.Сотрудник КАК Сотрудник, 				ОтобранныеСотрудники.ФизическоеЛицо КАК ФизическоеЛицо, 				ОтобранныеСотрудники.Подразделение КАК Подразделение, 				ОтобранныеСотрудники.Месяц КАК Месяц, 				ЕСТЬNULL(ДанныеСовокупныйНДФЛ.Сумма, 0) КАК Сумма, 				ПредставленияКадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода, 				ПредставленияКадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода 			ПОМЕСТИТЬ ДанныеСовокупныйНДФЛ 			ИЗ 				ВТГруппировкаСотрудниковПоМесяцам КАК ОтобранныеСотрудники 					ЛЕВОЕ СОЕДИНЕНИЕ ВТДанныеСовокупныйНДФЛ КАК ДанныеСовокупныйНДФЛ 					ПО ОтобранныеСотрудники.Организация.ГоловнаяОрганизация = ДанныеСовокупныйНДФЛ.ГоловнаяОрганизация 						И ОтобранныеСотрудники.ФизическоеЛицо = ДанныеСовокупныйНДФЛ.ФизическоеЛицо 						И ОтобранныеСотрудники.Месяц = ДанныеСовокупныйНДФЛ.Месяц 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудников КАК ПредставленияКадровыеДанныеСотрудников 					ПО ОтобранныеСотрудники.Сотрудник = ПредставленияКадровыеДанныеСотрудников.Сотрудник 						И (КОНЕЦПЕРИОДА(ОтобранныеСотрудники.Месяц, МЕСЯЦ) = ПредставленияКадровыеДанныеСотрудников.Период) 			ГДЕ 				ЕСТЬNULL(ДанныеСовокупныйНДФЛ.Сумма, 0) <> 0 				И НЕ ПредставленияКадровыеДанныеСотрудников.Должность ЕСТЬ NULL 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТГруппировкаДляДанныхНДФЛ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТСведенияОДоходахНДФЛ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТОблагаемыйДоходПоФизЛицам 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТСведенияОНДФЛ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТДанныеСовокупныйНДФЛ 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ДанныеСотрудников.Организация КАК Организация, 				ДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо, 				ДанныеСотрудников.Сотрудник КАК Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода КАК ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода КАК ПодразделениеНаКонецПериода, 				ДанныеСотрудников.МесяцНачисления КАК МесяцНачисления, 				ДанныеСотрудников.Группа КАК Группа, 				ДанныеСотрудников.ВидРасчета КАК ВидРасчета, 				СУММА(ДанныеСотрудников.Сумма) КАК Сумма, 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОтработаноДней, 0)) КАК ОтработаноДней, 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасов, 0)) КАК ОтработаноЧасов, 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОплаченоДней, 0)) КАК ОплаченоДней, 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОплаченоЧасов, 0)) КАК ОплаченоЧасов, 				NULL КАК СпособВыплаты, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Дата 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Дата 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ КАК ДатаДокументаОснования, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Номер 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Номер 					ИНАЧЕ &quot;&quot; 				КОНЕЦ КАК НомерДокументаОснования, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА &quot;Больничный&quot; 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА &quot;Отпуск&quot; 					ИНАЧЕ &quot;&quot; 				КОНЕЦ КАК ТипДокументаОснования, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаНачала 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).НачалоПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ КАК ДатаНачалаПериодаОтсутсвия, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаОкончания 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).КонецПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ КАК ДатаОкончанияПериодаОтсутствия, 				ПредставленияКадровыхДанныхНаКонецНачисления.Подразделение КАК ПодразделениеНаКонецНачисления, 				ПредставленияКадровыхДанныхНаКонецНачисления.Должность КАК ДолжностьНаКонецНачисления, 				ДанныеСотрудников.ДатаНачала КАК ДатаНачала, 				ДанныеСотрудников.ДатаОкончания КАК ДатаОкончания, 				СтатусыНалогоплательщиков.Статус КАК СтатусНалогоплательщика, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДатаОкончания ЕСТЬ NULL 							ИЛИ ДанныеСотрудников.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1) 						ТОГДА КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ) 					ИНАЧЕ ДанныеСотрудников.ДатаОкончания 				КОНЕЦ КАК ДатаДляПолучениеКадровогоДокумента, 				ДанныеСотрудников.ГрафикРаботы КАК ГрафикРаботы 			ПОМЕСТИТЬ ОбщийИтогБезПлановогоВремени 			ИЗ 				ВТНачисленияИУдержанияСКадровымиДанными КАК ДанныеСотрудников 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияОтработанноеВремя КАК ОтработанноеВремя 					ПО ДанныеСотрудников.Регистратор = ОтработанноеВремя.Регистратор 						И ДанныеСотрудников.Организация = ОтработанноеВремя.Организация 						И ДанныеСотрудников.Сотрудник = ОтработанноеВремя.Сотрудник 						И ДанныеСотрудников.Подразделение = ОтработанноеВремя.Подразделение 						И ДанныеСотрудников.ВидРасчета = ОтработанноеВремя.ВидРасчета 						И ДанныеСотрудников.МесяцНачисления = ОтработанноеВремя.МесяцНачисления 						И ДанныеСотрудников.ИдентификаторСтроки = ОтработанноеВремя.ИдентификаторСтроки 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыхДанныхНаКонецНачисления КАК ПредставленияКадровыхДанныхНаКонецНачисления 					ПО ДанныеСотрудников.Организация = ПредставленияКадровыхДанныхНаКонецНачисления.Организация 						И ДанныеСотрудников.ФизическоеЛицо = ПредставленияКадровыхДанныхНаКонецНачисления.ФизическоеЛицо 						И ДанныеСотрудников.Сотрудник = ПредставленияКадровыхДанныхНаКонецНачисления.Сотрудник 						И ДанныеСотрудников.ДатаОкончания = ПредставленияКадровыхДанныхНаКонецНачисления.ДатаОкончания 					ЛЕВОЕ СОЕДИНЕНИЕ СтатусыНалогоплательщиков КАК СтатусыНалогоплательщиков 					ПО ДанныеСотрудников.ФизическоеЛицо = СтатусыНалогоплательщиков.ФизическоеЛицо 						И (КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ) = СтатусыНалогоплательщиков.ПериодСбораДанных) 			ГДЕ 				ДанныеСотрудников.НачислениеТекущегоПериода 			 			СГРУППИРОВАТЬ ПО 				ДанныеСотрудников.МесяцНачисления, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Группа, 				ДанныеСотрудников.ВидРасчета, 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ПредставленияКадровыхДанныхНаКонецНачисления.Подразделение, 				ПредставленияКадровыхДанныхНаКонецНачисления.Должность, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Дата 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Дата 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Номер 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Номер 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА &quot;Больничный&quot; 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА &quot;Отпуск&quot; 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаНачала 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).НачалоПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаОкончания 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).КонецПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ДанныеСотрудников.ДатаНачала, 				ДанныеСотрудников.ДатаОкончания, 				СтатусыНалогоплательщиков.Статус, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДатаОкончания ЕСТЬ NULL 							ИЛИ ДанныеСотрудников.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1) 						ТОГДА КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ) 					ИНАЧЕ ДанныеСотрудников.ДатаОкончания 				КОНЕЦ, 				ДанныеСотрудников.ГрафикРаботы 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ДанныеСотрудников.МесяцНачисления, 				ДанныеСотрудников.Группа, 				ДанныеСотрудников.ВидРасчета, 				СУММА(ДанныеСотрудников.Сумма), 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОтработаноДней, 0)), 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасов, 0)), 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОплаченоДней, 0)), 				СУММА(ЕСТЬNULL(ОтработанноеВремя.ОплаченоЧасов, 0)), 				NULL, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Дата 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Дата 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Номер 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Номер 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА &quot;Больничный&quot; 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА &quot;Отпуск&quot; 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаНачала 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).НачалоПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаОкончания 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).КонецПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ПредставленияКадровыхДанныхНаКонецНачисления.Подразделение, 				ПредставленияКадровыхДанныхНаКонецНачисления.Должность, 				ДанныеСотрудников.ДатаНачала, 				ДанныеСотрудников.ДатаОкончания, 				СтатусыНалогоплательщиков.Статус, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДатаОкончания ЕСТЬ NULL 							ИЛИ ДанныеСотрудников.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1) 						ТОГДА КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ) 					ИНАЧЕ ДанныеСотрудников.ДатаОкончания 				КОНЕЦ, 				ДанныеСотрудников.ГрафикРаботы 			ИЗ 				ВТНачисленияИУдержанияСКадровымиДанными КАК ДанныеСотрудников 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияОтработанноеВремя КАК ОтработанноеВремя 					ПО ДанныеСотрудников.Регистратор = ОтработанноеВремя.Регистратор 						И ДанныеСотрудников.Организация = ОтработанноеВремя.Организация 						И ДанныеСотрудников.Сотрудник = ОтработанноеВремя.Сотрудник 						И ДанныеСотрудников.Подразделение = ОтработанноеВремя.Подразделение 						И ДанныеСотрудников.ВидРасчета = ОтработанноеВремя.ВидРасчета 						И ДанныеСотрудников.МесяцНачисления = ОтработанноеВремя.МесяцНачисления 						И ДанныеСотрудников.ИдентификаторСтроки = ОтработанноеВремя.ИдентификаторСтроки 					ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыхДанныхНаКонецНачисления КАК ПредставленияКадровыхДанныхНаКонецНачисления 					ПО ДанныеСотрудников.Организация = ПредставленияКадровыхДанныхНаКонецНачисления.Организация 						И ДанныеСотрудников.ФизическоеЛицо = ПредставленияКадровыхДанныхНаКонецНачисления.ФизическоеЛицо 						И ДанныеСотрудников.Сотрудник = ПредставленияКадровыхДанныхНаКонецНачисления.Сотрудник 						И ДанныеСотрудников.ДатаОкончания = ПредставленияКадровыхДанныхНаКонецНачисления.ДатаОкончания 					ЛЕВОЕ СОЕДИНЕНИЕ СтатусыНалогоплательщиков КАК СтатусыНалогоплательщиков 					ПО ДанныеСотрудников.ФизическоеЛицо = СтатусыНалогоплательщиков.ФизическоеЛицо 						И (КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ) = СтатусыНалогоплательщиков.ПериодСбораДанных) 			ГДЕ 				НЕ ДанныеСотрудников.НачислениеТекущегоПериода 				И НЕ ОтработанноеВремя.МесяцНачисления ЕСТЬ NULL 			 			СГРУППИРОВАТЬ ПО 				ДанныеСотрудников.МесяцНачисления, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Группа, 				ДанныеСотрудников.ВидРасчета, 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ПредставленияКадровыхДанныхНаКонецНачисления.Подразделение, 				ПредставленияКадровыхДанныхНаКонецНачисления.Должность, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Дата 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Дата 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).Номер 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).Номер 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА &quot;Больничный&quot; 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА &quot;Отпуск&quot; 					ИНАЧЕ &quot;&quot; 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаНачала 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).НачалоПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ВЫБОР 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.БольничныйЛист 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.БольничныйЛист).ДатаОкончания 					КОГДА ДанныеСотрудников.ДокументОснование ССЫЛКА Документ.Отпуск 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.ДокументОснование КАК Документ.Отпуск).КонецПериодаЗаКоторыйПредоставляетсяОтпуск 					ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1) 				КОНЕЦ, 				ДанныеСотрудников.ДатаНачала, 				ДанныеСотрудников.ДатаОкончания, 				СтатусыНалогоплательщиков.Статус, 				ДанныеСотрудников.ГрафикРаботы 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ДанныеСотрудников.МесяцНачисления, 				ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.Выплачено), 				ДанныеСотрудников.ВидРасчета, 				СУММА(ДанныеСотрудников.Сумма), 				СУММА(0), 				СУММА(0), 				СУММА(0), 				СУММА(0), 				ВЫБОР 					КОГДА ДанныеСотрудников.Регистратор ССЫЛКА Документ.ВедомостьНаВыплатуЗарплатыВБанк 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.Регистратор КАК Документ.ВедомостьНаВыплатуЗарплатыВБанк).СпособВыплаты 					КОГДА ДанныеСотрудников.Регистратор ССЫЛКА Документ.ВедомостьНаВыплатуЗарплатыВКассу 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.Регистратор КАК Документ.ВедомостьНаВыплатуЗарплатыВКассу).СпособВыплаты 					ИНАЧЕ НЕОПРЕДЕЛЕНО 				КОНЕЦ, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				КОНЕЦПЕРИОДА(ДанныеСотрудников.МесяцНачисления, МЕСЯЦ), 				ДанныеСотрудников.ГрафикРаботы 			ИЗ 				ВТДвиженияВзаиморасчетов КАК ДанныеСотрудников 			 			СГРУППИРОВАТЬ ПО 				ДанныеСотрудников.МесяцНачисления, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.ВидРасчета, 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ВЫБОР 					КОГДА ДанныеСотрудников.Регистратор ССЫЛКА Документ.ВедомостьНаВыплатуЗарплатыВБанк 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.Регистратор КАК Документ.ВедомостьНаВыплатуЗарплатыВБанк).СпособВыплаты 					КОГДА ДанныеСотрудников.Регистратор ССЫЛКА Документ.ВедомостьНаВыплатуЗарплатыВКассу 						ТОГДА ВЫРАЗИТЬ(ДанныеСотрудников.Регистратор КАК Документ.ВедомостьНаВыплатуЗарплатыВКассу).СпособВыплаты 					ИНАЧЕ НЕОПРЕДЕЛЕНО 				КОНЕЦ, 				ДанныеСотрудников.ГрафикРаботы 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбщийИтог.Организация КАК Организация, 				ОбщийИтог.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбщийИтог.Сотрудник КАК Сотрудник, 				ОбщийИтог.ДолжностьНаКонецПериода КАК ДолжностьНаКонецПериода, 				ОбщийИтог.ПодразделениеНаКонецПериода КАК ПодразделениеНаКонецПериода, 				ОбщийИтог.МесяцНачисления КАК МесяцНачисления, 				ОбщийИтог.Группа КАК Группа, 				ОбщийИтог.ВидРасчета КАК ВидРасчета, 				ОбщийИтог.Сумма КАК Сумма, 				ОбщийИтог.ОтработаноДней КАК ОтработаноДней, 				ОбщийИтог.ОтработаноЧасов КАК ОтработаноЧасов, 				ОбщийИтог.ОплаченоДней КАК ОплаченоДней, 				ОбщийИтог.ОплаченоЧасов КАК ОплаченоЧасов, 				ОбщийИтог.СпособВыплаты КАК СпособВыплаты, 				ОбщийИтог.ДатаДокументаОснования КАК ДатаДокументаОснования, 				ОбщийИтог.НомерДокументаОснования КАК НомерДокументаОснования, 				ОбщийИтог.ТипДокументаОснования КАК ТипДокументаОснования, 				ОбщийИтог.ДатаНачалаПериодаОтсутсвия КАК ДатаНачалаПериодаОтсутсвия, 				ОбщийИтог.ДатаОкончанияПериодаОтсутствия КАК ДатаОкончанияПериодаОтсутствия, 				ОбщийИтог.ПодразделениеНаКонецНачисления КАК ПодразделениеНаКонецНачисления, 				ОбщийИтог.ДолжностьНаКонецНачисления КАК ДолжностьНаКонецНачисления, 				ОбщийИтог.ДатаНачала КАК ДатаНачала, 				ОбщийИтог.ДатаОкончания КАК ДатаОкончания, 				ОбщийИтог.СтатусНалогоплательщика КАК СтатусНалогоплательщика, 				ОбщийИтог.ДатаДляПолучениеКадровогоДокумента КАК ДатаДляПолучениеКадровогоДокумента, 				0 КАК ПлановыеДни, 				0 КАК ПлановыеЧасы 			ПОМЕСТИТЬ ОбщийИтог 			ИЗ 				ОбщийИтогБезПлановогоВремени КАК ОбщийИтог			 			СГРУППИРОВАТЬ ПО 				ОбщийИтог.Организация, 				ОбщийИтог.ФизическоеЛицо, 				ОбщийИтог.Сотрудник, 				ОбщийИтог.ДолжностьНаКонецПериода, 				ОбщийИтог.ПодразделениеНаКонецПериода, 				ОбщийИтог.МесяцНачисления, 				ОбщийИтог.Группа, 				ОбщийИтог.ВидРасчета, 				ОбщийИтог.Сумма, 				ОбщийИтог.ОтработаноДней, 				ОбщийИтог.ОтработаноЧасов, 				ОбщийИтог.ОплаченоДней, 				ОбщийИтог.ОплаченоЧасов, 				ОбщийИтог.СпособВыплаты, 				ОбщийИтог.ДатаДокументаОснования, 				ОбщийИтог.НомерДокументаОснования, 				ОбщийИтог.ТипДокументаОснования, 				ОбщийИтог.ДатаНачалаПериодаОтсутсвия, 				ОбщийИтог.ДатаОкончанияПериодаОтсутствия, 				ОбщийИтог.ПодразделениеНаКонецНачисления, 				ОбщийИтог.ДолжностьНаКонецНачисления, 				ОбщийИтог.ДатаНачала, 				ОбщийИтог.ДатаОкончания, 				ОбщийИтог.СтатусНалогоплательщика, 				ОбщийИтог.ДатаДляПолучениеКадровогоДокумента 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбщийИтог.Организация КАК Организация, 				ОбщийИтог.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбщийИтог.Сотрудник КАК Сотрудник, 				ОбщийИтог.ДолжностьНаКонецПериода КАК ДолжностьНаКонецПериода, 				ОбщийИтог.ПодразделениеНаКонецПериода КАК ПодразделениеНаКонецПериода, 				ОбщийИтог.МесяцНачисления КАК МесяцНачисления, 				ОбщийИтог.Группа КАК Группа, 				СУММА(ОбщийИтог.Сумма) КАК Итог, 				КОНЕЦПЕРИОДА(ОбщийИтог.МесяцНачисления, МЕСЯЦ) КАК ДатаДляПолучениеКадровогоДокумента 			ПОМЕСТИТЬ ИтогПоГруппам 			ИЗ 				ОбщийИтог КАК ОбщийИтог 			 			СГРУППИРОВАТЬ ПО 				ОбщийИтог.Организация, 				ОбщийИтог.ФизическоеЛицо, 				ОбщийИтог.Сотрудник, 				ОбщийИтог.ДолжностьНаКонецПериода, 				ОбщийИтог.ПодразделениеНаКонецПериода, 				ОбщийИтог.МесяцНачисления, 				ОбщийИтог.Группа 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ДанныеСотрудников.Период, 				ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.КонечноеСальдо), 				СУММА(ДанныеСотрудников.КонечныйОстаток), 				КОНЕЦПЕРИОДА(ДанныеСотрудников.Период, МЕСЯЦ) 			ИЗ 				ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников 			 			СГРУППИРОВАТЬ ПО 				ДанныеСотрудников.Период, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода, 				ДанныеСотрудников.Период, 				ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.НачальноеСальдо), 				СУММА(ДанныеСотрудников.НачальныйОстаток), 				КОНЕЦПЕРИОДА(ДанныеСотрудников.Период, МЕСЯЦ) 			ИЗ 				ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников 			 			СГРУППИРОВАТЬ ПО 				ДанныеСотрудников.Период, 				ДанныеСотрудников.ФизическоеЛицо, 				ДанныеСотрудников.Организация, 				ДанныеСотрудников.Сотрудник, 				ДанныеСотрудников.ДолжностьНаКонецПериода, 				ДанныеСотрудников.ПодразделениеНаКонецПериода 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеОблагаемыйНалог.Организация, 				ДанныеОблагаемыйНалог.ФизическоеЛицо, 				ДанныеОблагаемыйНалог.Сотрудник, 				ДанныеОблагаемыйНалог.ДолжностьНаКонецПериода, 				ДанныеОблагаемыйНалог.ПодразделениеНаКонецПериода, 				ДанныеОблагаемыйНалог.Месяц, 				&quot;ОблагаемыйДоход&quot;, 				ДанныеОблагаемыйНалог.ОблагаемыйДоход, 				КОНЕЦПЕРИОДА(ДанныеОблагаемыйНалог.Месяц, МЕСЯЦ) 			ИЗ 				ДанныеОблагаемыйНалог КАК ДанныеОблагаемыйНалог 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеСовокупныйНДФЛ.Организация, 				ДанныеСовокупныйНДФЛ.ФизическоеЛицо, 				ДанныеСовокупныйНДФЛ.Сотрудник, 				ДанныеСовокупныйНДФЛ.ДолжностьНаКонецПериода, 				ДанныеСовокупныйНДФЛ.ПодразделениеНаКонецПериода, 				ДанныеСовокупныйНДФЛ.Месяц, 				&quot;СовокупныйНДФЛ&quot;, 				ДанныеСовокупныйНДФЛ.Сумма, 				КОНЕЦПЕРИОДА(ДанныеСовокупныйНДФЛ.Месяц, МЕСЯЦ) 			ИЗ 				ДанныеСовокупныйНДФЛ КАК ДанныеСовокупныйНДФЛ 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ДанныеВычеты.Организация, 				ДанныеВычеты.ФизическоеЛицо, 				ДанныеВычеты.Сотрудник, 				ДанныеВычеты.ДолжностьНаКонецПериода, 				ДанныеВычеты.ПодразделениеНаКонецПериода, 				ДанныеВычеты.Месяц, 				&quot;ПредоставленныеВычеты&quot;, 				ДанныеВычеты.СуммаВычета, 				КОНЕЦПЕРИОДА(ДанныеВычеты.Месяц, МЕСЯЦ) 			ИЗ 				ДанныеВычеты КАК ДанныеВычеты 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбщийИтог.Сотрудник КАК Сотрудник, 				ОбщийИтог.ДатаДляПолучениеКадровогоДокумента КАК ПериодСбораДанных 			ПОМЕСТИТЬ ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокументаБезГруппировки 			ИЗ 				ОбщийИтог КАК ОбщийИтог 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ИтогПоГруппам.Сотрудник, 				ИтогПоГруппам.ДатаДляПолучениеКадровогоДокумента 			ИЗ 				ИтогПоГруппам КАК ИтогПоГруппам 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				Группировка.Сотрудник КАК Сотрудник, 				Группировка.ПериодСбораДанных КАК ПериодСбораДанных 			ПОМЕСТИТЬ ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокументаБезГруппировки КАК Группировка 			 			СГРУППИРОВАТЬ ПО 				Группировка.Сотрудник, 				Группировка.ПериодСбораДанных 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник КАК Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных КАК ПериодСбораДанных, 				NULL КАК ДатаДокумента, 				NULL КАК Документ 			ПОМЕСТИТЬ ВТ_КадровыеДокументыПоДатам 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				КадровыйПеревод.ДатаНачала, 				КадровыйПеревод.Ссылка 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 					ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КадровыйПеревод КАК КадровыйПеревод 					ПО ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник = КадровыйПеревод.Сотрудник 						И ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных >= КадровыйПеревод.ДатаНачала 						И (КадровыйПеревод.Проведен) 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 								 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 								 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 							 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				ПриемНаРаботу.ДатаПриема, 				ПриемНаРаботу.Ссылка 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 					ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПриемНаРаботу КАК ПриемНаРаботу 					ПО ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник = ПриемНаРаботу.Сотрудник 						И ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных >= ПриемНаРаботу.ДатаПриема 						И (ПриемНаРаботу.Проведен) 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.Сотрудник, 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента.ПериодСбораДанных, 				NULL, 				NULL 			ИЗ 				ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента КАК ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВТ_КадровыеДокументыПоДатам.Сотрудник КАК Сотрудник, 				ВТ_КадровыеДокументыПоДатам.ПериодСбораДанных КАК ПериодСбораДанных, 				МАКСИМУМ(ВТ_КадровыеДокументыПоДатам.ДатаДокумента) КАК МаксДатаДокумента 			ПОМЕСТИТЬ ВТ_МаксимальнаяДатаКадровогоДокумента 			ИЗ 				ВТ_КадровыеДокументыПоДатам КАК ВТ_КадровыеДокументыПоДатам 			 			СГРУППИРОВАТЬ ПО 				ВТ_КадровыеДокументыПоДатам.Сотрудник, 				ВТ_КадровыеДокументыПоДатам.ПериодСбораДанных 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ВТ_МаксимальнаяДатаКадровогоДокумента.Сотрудник КАК Сотрудник, 				ВТ_МаксимальнаяДатаКадровогоДокумента.ПериодСбораДанных КАК ПериодСбораДанных, 				МАКСИМУМ(ВТ_КадровыеДокументыПоДатам.Документ) КАК Документ 			ПОМЕСТИТЬ КадровыеДокументыНаДату 			ИЗ 				ВТ_КадровыеДокументыПоДатам КАК ВТ_КадровыеДокументыПоДатам 					ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_МаксимальнаяДатаКадровогоДокумента КАК ВТ_МаксимальнаяДатаКадровогоДокумента 					ПО ВТ_КадровыеДокументыПоДатам.Сотрудник = ВТ_МаксимальнаяДатаКадровогоДокумента.Сотрудник 						И ВТ_КадровыеДокументыПоДатам.ПериодСбораДанных = ВТ_МаксимальнаяДатаКадровогоДокумента.ПериодСбораДанных 						И ВТ_КадровыеДокументыПоДатам.ДатаДокумента = ВТ_МаксимальнаяДатаКадровогоДокумента.МаксДатаДокумента 			 			СГРУППИРОВАТЬ ПО 				ВТ_МаксимальнаяДатаКадровогоДокумента.Сотрудник, 				ВТ_МаксимальнаяДатаКадровогоДокумента.ПериодСбораДанных 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокументаБезГруппировки 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТ_ГруппировкаДляОпределенияПоследнегоКадровогоДокумента 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТ_КадровыеДокументыПоДатам 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			УНИЧТОЖИТЬ ВТ_МаксимальнаяДатаКадровогоДокумента 			; 			 			//////////////////////////////////////////////////////////////////////////////// 			ВЫБРАТЬ РАЗРЕШЕННЫЕ 				ОбщийИтог.Организация КАК Организация, 				ОбщийИтог.ФизическоеЛицо КАК ФизическоеЛицо, 				ОбщийИтог.Сотрудник КАК Сотрудник, 				ОбщийИтог.ДолжностьНаКонецПериода КАК ДолжностьНаКонецПериода, 				ОбщийИтог.ПодразделениеНаКонецПериода КАК ПодразделениеНаКонецПериода, 				ОбщийИтог.МесяцНачисления КАК МесяцНачисления, 				КОНЕЦПЕРИОДА(ОбщийИтог.МесяцНачисления, МЕСЯЦ) КАК КонецМесяцаНачисления, 				ОбщийИтог.Группа КАК Группа, 				ОбщийИтог.ВидРасчета КАК ВидРасчета, 				ОбщийИтог.Сумма КАК Сумма, 				ОбщийИтог.ОтработаноДней КАК ОтработаноДней, 				ОбщийИтог.ОтработаноЧасов КАК ОтработаноЧасов, 				ОбщийИтог.ОплаченоДней КАК ОплаченоДней, 				ОбщийИтог.ОплаченоЧасов КАК ОплаченоЧасов, 				ОбщийИтог.СпособВыплаты КАК СпособВыплаты, 				ОбщийИтог.ДатаДокументаОснования КАК ДатаДокументаОснования, 				ОбщийИтог.НомерДокументаОснования КАК НомерДокументаОснования, 				ОбщийИтог.ТипДокументаОснования КАК ТипДокументаОснования, 				ОбщийИтог.ДатаНачалаПериодаОтсутсвия КАК ДатаНачалаПериодаОтсутсвия, 				ОбщийИтог.ДатаОкончанияПериодаОтсутствия КАК ДатаОкончанияПериодаОтсутствия, 				ОбщийИтог.ПодразделениеНаКонецНачисления КАК ПодразделениеНаКонецНачисления, 				ОбщийИтог.ДолжностьНаКонецНачисления КАК ДолжностьНаКонецНачисления, 				0 КАК Итог, 				ОбщийИтог.ПлановыеДни КАК ПлановыеДни, 				ОбщийИтог.ПлановыеЧасы КАК ПлановыеЧасы, 				ОбщийИтог.ПодразделениеНаКонецПериода.Наименование КАК ПодразделениеНаКонецПериодаНаименование, 				ОбщийИтог.Организация.Наименование КАК ОрганизацияНаименование, 				ОбщийИтог.ДатаНачала КАК ДатаНачалаНачисления, 				ОбщийИтог.ДатаОкончания КАК ДатаОкончанияНачисления, 				КадровыеДокументыНаДату.Документ КАК ПоследнийКадровыйДокумент, 				ВЫБОР 					КОГДА ОбщийИтог.СтатусНалогоплательщика = ЗНАЧЕНИЕ(Справочник.СтатусыНалогоплательщиковПоНДФЛ.Нерезидент) 						ТОГДА ИСТИНА 					ИНАЧЕ ЛОЖЬ 				КОНЕЦ КАК Нерезидент 			ИЗ 				ОбщийИтог КАК ОбщийИтог 					ЛЕВОЕ СОЕДИНЕНИЕ КадровыеДокументыНаДату КАК КадровыеДокументыНаДату 					ПО ОбщийИтог.Сотрудник = КадровыеДокументыНаДату.Сотрудник 						И ОбщийИтог.ДатаДляПолучениеКадровогоДокумента = КадровыеДокументыНаДату.ПериодСбораДанных 			 			ОБЪЕДИНИТЬ ВСЕ 			 			ВЫБРАТЬ 				ИтогПоГруппам.Организация, 				ИтогПоГруппам.ФизическоеЛицо, 				ИтогПоГруппам.Сотрудник, 				ИтогПоГруппам.ДолжностьНаКонецПериода, 				ИтогПоГруппам.ПодразделениеНаКонецПериода, 				ИтогПоГруппам.МесяцНачисления, 				КОНЕЦПЕРИОДА(ИтогПоГруппам.МесяцНачисления, МЕСЯЦ), 				ИтогПоГруппам.Группа, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				NULL, 				ИтогПоГруппам.Итог, 				NULL, 				NULL, 				ИтогПоГруппам.ПодразделениеНаКонецПериода.Наименование, 				ИтогПоГруппам.Организация.Наименование, 				NULL, 				NULL, 				КадровыеДокументыНаДату.Документ, 				NULL 			ИЗ 				ИтогПоГруппам КАК ИтогПоГруппам 					ЛЕВОЕ СОЕДИНЕНИЕ КадровыеДокументыНаДату КАК КадровыеДокументыНаДату 					ПО ИтогПоГруппам.Сотрудник = КадровыеДокументыНаДату.Сотрудник 						И ИтогПоГруппам.ДатаДляПолучениеКадровогоДокумента = КадровыеДокументыНаДату.ПериодСбораДанных 			 			УПОРЯДОЧИТЬ ПО 				Сотрудник, 				Группа";
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "&quot;", Символы.ВК+"""");	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "ВЫБРАТЬ", Символы.ВК+"ВЫБРАТЬ");
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, ";", ";"+Символы.ВК);
	Запрос.Текст = ТекстЗапроса;
	
	Запрос.УстановитьПараметр("ЕстьФильтрПоОрганизации", 	ПараметрыЗапроса.ЕстьФильтрПоОрганизации);
	Запрос.УстановитьПараметр("ЕстьФильтрПоСотрудникам", 	ПараметрыЗапроса.ЕстьФильтрПоСотрудникам);
	Запрос.УстановитьПараметр("КонецПериода", 				ПараметрыЗапроса.КонецПериода);
	Запрос.УстановитьПараметр("НачалоПериода", 				ПараметрыЗапроса.НачалоПериода);
	Запрос.УстановитьПараметр("Организация", 				ПараметрыЗапроса.Организация);
	Запрос.УстановитьПараметр("ФизическиеЛица", 			ПараметрыЗапроса.ФизическиеЛица);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Сотрудники = "";
				
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Если Найти(Сотрудники, Строка(ВыборкаДетальныеЗаписи.ФизическоеЛицо)) > 0 Тогда
			Продолжить;
		Иначе
			Сотрудники = Сотрудники + ";" + Строка(ВыборкаДетальныеЗаписи.ФизическоеЛицо);
		КонецЕсли;	
		
		Вложение = Новый Соответствие;
		Попытка
			ОтчетРасчетныйЛисток = ЗарплатаКадрыОтчеты.ОтчетРасчетныйЛисток();
			//Т.К. версионирование у нас только для метпаданных. пока ошибку обходим через попытку
			Попытка
				Результат = Отчеты.АнализНачисленийИУдержаний.ДанныеРасчетныхЛистков(
				            ВыборкаДетальныеЗаписи.ФизическоеЛицо,
							ВыборкаДетальныеЗаписи.Организация,
							ПараметрыЗапроса.НачалоПериода,
							ПараметрыЗапроса.КонецПериода,
							ОтчетРасчетныйЛисток);
			Исключение
				//Начиная с Версии ЗУП 3.1.24.408			
				Результат = ЗарплатаКадрыОтчеты.ДанныеРасчетныхЛистков(
				            ВыборкаДетальныеЗаписи.ФизическоеЛицо,
							ВыборкаДетальныеЗаписи.Организация,
							ПараметрыЗапроса.НачалоПериода,
							ПараметрыЗапроса.КонецПериода,
							ОтчетРасчетныйЛисток);
			КонецПопытки;
			ДокументРезультат = Результат.ДокументРезультат;
			
			НазваниеПФ = "Расчетный листок от " + Формат(ПараметрыЗапроса.НачалоПериода, "ДЛФ=Д") + " по " + Формат(ПараметрыЗапроса.КонецПериода, "ДЛФ=Д") + " для " + Строка(ВыборкаДетальныеЗаписи.ФизическоеЛицо);
			Вложение["Название"] = НазваниеПФ; 
			
			ПотокВПамяти = Новый ПотокВПамяти;
			ДокументРезультат.Записать(ПотокВПамяти, ТипФайлаТабличногоДокумента.PDF);
			ФайлBase64 = Base64Строка(ПотокВПамяти.ЗакрытьИПолучитьДвоичныеДанные());
						
			Вложение["Файл"] = Новый Соответствие;
			Вложение["Файл"].Вставить("Имя", НазваниеПФ+".pdf");
			Вложение["Файл"].Вставить("ДвоичныеДанные", ФайлBase64);
			Вложение["Файл"].Вставить("ContentType", "application/pdf");;
		Исключение
			ИнфОбОшибке = ИнформацияОбОшибке();
		КонецПопытки; 
		
        МассивВложений = Новый Массив;
		МассивВложений.Добавить(Вложение);
		
		ПараметрыПКД = Новый Структура("ЕстьФильтрПоОрганизации, ЕстьФильтрПоСотрудникам, НачалоПериода, КонецПериода, Организация, ФизическоеЛицо, _print_forms",
		ПараметрыЗапроса.ЕстьФильтрПоОрганизации,
		ПараметрыЗапроса.ЕстьФильтрПоСотрудникам,
		ПараметрыЗапроса.НачалоПериода,
		ПараметрыЗапроса.КонецПериода,
		ПараметрыЗапроса.Организация,
		ВыборкаДетальныеЗаписи.ФизическоеЛицо,
		МассивВложений);
		
		ПараметрыВызова.Добавить(ПараметрыПКД);
	КонецЦикла;	
	
	Возврат ПараметрыВызова;
КонецФункции 
